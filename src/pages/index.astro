---
import HeroSection from "../components/HeroSection.astro";
import UltimosPosts from "../components/UltimosPosts.astro";
import Sidebar from "../components/SideBar.astro";
import RelativityBackground from "../components/RelativityBackground";
---

<html lang="es" data-theme="lofi">
  <head>
    <meta charset="UTF-8" />
    <title>Antonio Cañada</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>

  <body class="relative min-h-screen bg-white text-gray-900">
    <RelativityBackground client:load />

    <div class="drawer lg:drawer-open">
      <input id="my-drawer" type="checkbox" class="drawer-toggle" />

      <!-- Contenido principal -->
      <div class="drawer-content flex flex-col h-screen">
        <!-- Botón de abrir sidebar en móviles -->
        <label
          for="my-drawer"
          class="btn btn-primary drawer-button lg:hidden w-fit fixed top-4 left-4 z-30"
        >
          ☰
        </label>

        <!-- Espaciador para móviles debajo del botón hamburguesa -->
        <div class="lg:hidden h-[4rem] w-full"></div>

        <main
          class="flex-1 h-full overflow-y-auto snap-y snap-mandatory scroll-smooth"
        >
          <!-- Primera sección -->
          <section
            id="hero"
            class="h-screen flex items-center justify-center px-6 snap-start"
          >
            <HeroSection />
            <div
              id="scroll-indicator"
              class="absolute bottom-6 left-1/2 -translate-x-1/2 lg:left-[calc(50%+10rem)] lg:-translate-x-1/2 text-gray-500 animate-bounce text-2xl transition-opacity duration-500"
            >
              <a href="#contenido" aria-label="Desliza hacia abajo">↓</a>
            </div>
          </section>

          <!-- Segunda sección -->
          <section
            id="contenido"
            class="h-screen px-6 py-12 snap-start overflow-y-auto"
          >
            <div class="max-w-4xl mx-auto space-y-12">
              <UltimosPosts />
            </div>
          </section>
        </main>
      </div>

      <!-- Sidebar dentro de drawer-side -->
      <div class="drawer-side absolute top-0 bottom-0 h-screen z-20">
        <label for="my-drawer" class="drawer-overlay"></label>
        <Sidebar sideBarActiveItemID="home" />
      </div>
    </div>
  </body>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const indicator = document.getElementById("scroll-indicator");
      const target = document.getElementById("contenido");

      if (!indicator || !target) return; // aseguramos que ambos existen

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            indicator.style.opacity = entry.isIntersecting ? "0" : "1";
          });
        },
        { threshold: 0.1 }
      );

      observer.observe(target);
    });
  </script>
</html>
